# ============================================
# OPEX Manager - Production Environment Configuration
# Optimized for Large Scale (500-2000 Users)
# ============================================

# ============================================
# Server Configuration
# ============================================
NODE_ENV=production
PORT=5000
APP_NAME=OPEX Manager
APP_URL=https://opex.yourcompany.com
API_VERSION=v1

# ============================================
# Database Configuration (PostgreSQL)
# ============================================
# Primary database with connection pooling
DATABASE_URL=postgresql://username:password@db-primary.yourcompany.com:5432/opex_db?schema=public&connection_limit=20&pool_timeout=10&connect_timeout=10

# Read replica for reports (optional but recommended)
DATABASE_READ_REPLICA_URL=postgresql://username:password@db-replica.yourcompany.com:5432/opex_db?schema=public&connection_limit=10&pool_timeout=10

# Database connection pool settings
DATABASE_CONNECTION_LIMIT=20
DATABASE_POOL_TIMEOUT=10

# ============================================
# Redis Cache Configuration (CRITICAL for scale)
# ============================================
CACHE_ENABLED=true
REDIS_HOST=redis-cluster.cache.yourcompany.com
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password_here
REDIS_DB=0
CACHE_TTL=3600

# ============================================
# Security Configuration
# ============================================
# IMPORTANT: Generate strong secrets for production
# Use: openssl rand -base64 48
JWT_SECRET=CHANGE_THIS_TO_A_STRONG_SECRET_MIN_32_CHARACTERS_LONG
SESSION_SECRET=CHANGE_THIS_TO_ANOTHER_STRONG_SECRET_MIN_32_CHARACTERS

# Password hashing rounds (10-12 recommended for production)
BCRYPT_ROUNDS=10

# Cookie settings
COOKIE_SECURE=true
COOKIE_HTTP_ONLY=true
COOKIE_SAME_SITE=strict

# ============================================
# CORS Configuration
# ============================================
CORS_ORIGIN=https://opex.yourcompany.com
CORS_CREDENTIALS=true

# ============================================
# Rate Limiting (Optimized for large scale)
# ============================================
# 15 minutes window
RATE_LIMIT_WINDOW_MS=900000
# 200 requests per window (increased for scale)
RATE_LIMIT_MAX_REQUESTS=200
# Login attempts limit
RATE_LIMIT_LOGIN_MAX=10

# ============================================
# File Upload Configuration
# ============================================
MAX_FILE_SIZE=10485760
UPLOAD_DIR=./uploads
ALLOWED_FILE_TYPES=.xlsx,.xls,.csv

# ============================================
# Performance Configuration
# ============================================
# Enable compression (CRITICAL for bandwidth savings)
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6

# Maximum payload size
MAX_PAYLOAD_SIZE=50mb

# ============================================
# Logging Configuration
# ============================================
LOG_LEVEL=info
LOG_FILE=./logs/app.log
LOG_MAX_SIZE=10m
LOG_MAX_FILES=7
PRETTY_LOGS=false

# ============================================
# Email Configuration (Optional)
# ============================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@yourcompany.com
SMTP_PASS=your-email-password
EMAIL_FROM=OPEX Manager <noreply@yourcompany.com>

# ============================================
# Feature Flags
# ============================================
ENABLE_REGISTRATION=false
ENABLE_EMAIL_VERIFICATION=false
ENABLE_TWO_FACTOR=false
ENABLE_AUDIT_LOG=true
ENABLE_ACTIVITY_LOG=true

# ============================================
# Backup Configuration
# ============================================
BACKUP_DIR=./backups
BACKUP_RETENTION_DAYS=30
AUTO_BACKUP_ENABLED=true
AUTO_BACKUP_SCHEDULE=0 2 * * *

# ============================================
# CDN Configuration (for static assets)
# ============================================
CDN_URL=https://cdn.yourcompany.com
CDN_ENABLED=true

# ============================================
# Monitoring & Observability
# ============================================
# Enable performance monitoring
ENABLE_PERFORMANCE_MONITORING=true

# APM (Application Performance Monitoring)
# Uncomment if using New Relic, Datadog, etc.
# NEW_RELIC_LICENSE_KEY=your_key_here
# DATADOG_API_KEY=your_key_here

# ============================================
# AWS Configuration (if using AWS services)
# ============================================
# AWS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your_access_key
# AWS_SECRET_ACCESS_KEY=your_secret_key
# S3_BUCKET=opex-uploads

# ============================================
# Financial Year Configuration
# ============================================
# FY is auto-calculated based on April-March cycle
# Override only if needed
# DEFAULT_FY=FY25

# ============================================
# Development/Debug (Set to false in production)
# ============================================
DEBUG=false

# ============================================
# Health Check Configuration
# ============================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health

# ============================================
# Session Configuration
# ============================================
SESSION_TIMEOUT=86400000

# ============================================
# Timezone
# ============================================
TZ=Asia/Kolkata

# ============================================
# Notes for Production Deployment
# ============================================
# 1. NEVER commit this file with real credentials
# 2. Use environment-specific secret management (AWS Secrets Manager, Azure Key Vault, etc.)
# 3. Rotate secrets regularly (every 90 days recommended)
# 4. Enable all security features (HTTPS, secure cookies, etc.)
# 5. Monitor logs and set up alerts for errors
# 6. Test thoroughly in staging before production deployment
# 7. Keep backups and test restore procedures regularly
# 8. Use read replicas for heavy reporting queries
# 9. Enable Redis caching for optimal performance
# 10. Set up CDN for static assets to reduce bandwidth costs
